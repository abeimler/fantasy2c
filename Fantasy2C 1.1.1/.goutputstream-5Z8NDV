#!/usr/bin/make

$(OBJECTSDEBUG): $(DEBUGDIR)/$(OBJDIR)/%.$(OBJSUF): $(SRCDIR)/%.$(SRCSUF) $(DEBUGDIR)/$(OBJDIR)/.tag
	$(CXX) $(DEBUGFLAGS) $(CXXFLAGS) $(DEFAULTFLAGS) $(INCLUDEDIRFLAG)$(HEADERSDIR) $(SRCFLAG) "$<" $(OUTFLAG)"$@" 


$(OBJECTSRELEASE): $(RELEASEDIR)/$(OBJDIR)/%.$(OBJSUF): $(SRCDIR)/%.$(SRCSUF) $(RELEASEDIR)/$(OBJDIR)/.tag
	$(CXX) $(RELEASEFLAGS) $(CXXFLAGS) $(DEFAULTFLAGS) $(INCLUDEDIRFLAG)$(HEADERSDIR) $(SRCFLAG) "$<" $(OUTFLAG)"$@" 

debugdirs:
	mkdir -p "$(DEBUGDIR)/$(OBJDIR)"
	mkdir -p "$(DEBUGDIR)/$(OUTDIR)"
                
releasedirs:
	mkdir -p "$(RELEASEDIR)/$(OBJDIR)"
	mkdir -p "$(RELEASEDIR)/$(OUTDIR)"

%.tag:
	mkdir -p "$(dir $(@))"


Debug : debugdirs $(OBJECTSDEBUG)
	$(LD) $(DEBUGFLAGS) $(DEFAULTFLAGS) $(INCLUDEDIRFLAG)$(HEADERSDIR) $(SOFLAGS) $(LDFLAGS) $(OBJECTSDEBUG) $(OUTFLAG)$(DEBUGDIR)/$(OUTDIR)/$(OUTLIB).$(OUTLIBSUF) $(LIBFLAGS)
 
Release : releasedirs $(OBJECTSRELEASE)
	$(LD) $(RELEASEFLAGS) $(DEFAULTFLAGS) $(INCLUDEDIRFLAG)$(HEADERSDIR) $(SOFLAGS) $(LDFLAGS) $(OBJECTSRELEASE) $(OUTFLAG)$(RELEASEDIR)/$(OUTDIR)/$(OUTLIB).$(OUTLIBSUF) $(LIBFLAGS)

clean: cleanDebug cleanRelease


cleanDebug:
	rm -r -f "$(DEBUGDIR)/$(OBJDIR)"

cleanRelease:
	rm -r -f "$(RELEASEDIR)/$(OBJDIR)"
